<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èµ„æºåº“ - Grassroots Project</title>
  <link rel="stylesheet" href="../assets/css/styles.css">
  <style>
    .hero-section {
      text-align: center;
      padding: 2rem 0 1rem;
    }
    .hero-section h1 { margin-bottom: 0.5rem; }
    .hero-section p { color: #666; max-width: 500px; margin: 0 auto; }

    /* Stats Bar */
    .stats-bar {
      display: flex;
      justify-content: center;
      gap: 2.5rem;
      padding: 1.5rem 0;
      margin: 1.5rem 0;
      border-top: 1px solid var(--border-color);
      border-bottom: 1px solid var(--border-color);
    }
    .stat-item { text-align: center; }
    .stat-item .num {
      font-size: 2rem;
      font-weight: 700;
      line-height: 1;
    }
    .stat-item .num.green { color: #16a34a; }
    .stat-item .num.yellow { color: #ca8a04; }
    .stat-item .num.default { color: var(--primary-color); }
    .stat-item .lbl {
      font-size: 0.8rem;
      color: #888;
      margin-top: 4px;
    }

    /* Filter */
    .filter-bar {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }
    .filter-btn {
      padding: 6px 14px;
      border: 1px solid var(--border-color);
      border-radius: 20px;
      background: none;
      cursor: pointer;
      font-size: 0.85rem;
      color: #555;
      transition: all 0.2s;
    }
    .filter-btn:hover { border-color: var(--accent-color); color: var(--accent-color); }
    .filter-btn.active {
      background: var(--accent-color);
      color: white;
      border-color: var(--accent-color);
    }

    /* Resource Cards */
    .resource-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.2rem;
    }

    .resource-card {
      background: var(--light-gray);
      border-radius: 14px;
      padding: 1.5rem;
      transition: transform 0.2s, box-shadow 0.2s;
      position: relative;
    }
    .resource-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    }

    .resource-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.6rem;
    }
    .resource-name {
      font-size: 1.15rem;
      font-weight: 600;
      color: var(--primary-color);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .resource-badge {
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
      white-space: nowrap;
    }
    .badge-available { background: #dcfce7; color: #166534; }
    .badge-pending { background: #fef3c7; color: #92400e; }
    .badge-occupied { background: #fee2e2; color: #991b1b; }

    .resource-type {
      display: inline-block;
      padding: 2px 10px;
      background: #e5e7eb;
      border-radius: 10px;
      font-size: 0.75rem;
      color: #555;
      margin-bottom: 0.6rem;
    }

    .resource-desc {
      color: #555;
      font-size: 0.9rem;
      line-height: 1.5;
      margin-bottom: 0.8rem;
    }

    .resource-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 0.82rem;
      color: #888;
      padding-top: 0.8rem;
      border-top: 1px solid var(--border-color);
    }

    .resource-link {
      display: inline-block;
      margin-top: 0.8rem;
      padding: 5px 12px;
      background: var(--accent-color);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-size: 0.82rem;
      transition: opacity 0.2s;
    }
    .resource-link:hover { opacity: 0.85; }

    /* Rules */
    .rules-section {
      margin-top: 2.5rem;
      padding: 1.5rem;
      background: var(--light-gray);
      border-radius: 14px;
    }
    .rules-section h2 { font-size: 1.1rem; margin-bottom: 0.8rem; }
    .rules-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 0.8rem;
    }
    .rule-item {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      font-size: 0.88rem;
      color: #555;
    }
    .rule-icon { font-size: 1.1rem; flex-shrink: 0; }

    .empty-state {
      text-align: center;
      padding: 3rem;
      color: #999;
      grid-column: 1 / -1;
    }

    @media (max-width: 640px) {
      .stats-bar { gap: 1.5rem; }
      .stat-item .num { font-size: 1.5rem; }
      .resource-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <nav>
    <a href="../index.html" class="logo">ğŸŒ± Grassroots Project</a>
    <div class="hamburger" onclick="toggleMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <ul id="nav-menu">
      <li><a href="../index.html">ğŸ  é¦–é¡µ</a></li>
      <li><a href="about.html">ğŸ’¡ å…³äº</a></li>
      <li><a href="tasks.html">ğŸ“‹ ä»»åŠ¡æ± </a></li>
      <li><a href="kanban.html">ğŸ“Š çœ‹æ¿</a></li>
      <li><a href="people.html">ğŸ‘¥ äººæ‰åº“</a></li>
      <li><a href="resources.html" class="active">ğŸ“¦ èµ„æºåº“</a></li>
      <li><a href="assistant.html">ğŸ¤– AI åŠ©æ‰‹</a></li>
      <li><a href="join.html">ğŸš€ åŠ å…¥æˆ‘ä»¬</a></li>
    </ul>
  </nav>

  <main>
    <div class="hero-section">
      <h1>ğŸ“¦ èµ„æºåº“</h1>
      <p>å¼€æ”¾çš„èµ„æºï¼Œä¾›åä½œä½¿ç”¨ã€‚å…ˆæ²Ÿé€šï¼Œåä½¿ç”¨ï¼ŒåŠæ—¶æ›´æ–°çŠ¶æ€ã€‚</p>
    </div>

    <!-- Stats -->
    <div class="stats-bar">
      <div class="stat-item">
        <div class="num default" id="stat-total">-</div>
        <div class="lbl">æ€»èµ„æº</div>
      </div>
      <div class="stat-item">
        <div class="num green" id="stat-available">-</div>
        <div class="lbl">å¯ç”¨</div>
      </div>
      <div class="stat-item">
        <div class="num yellow" id="stat-pending">-</div>
        <div class="lbl">å¾…è§„åˆ’</div>
      </div>
    </div>

    <!-- Filter -->
    <div class="filter-bar" id="filter-bar">
      <button class="filter-btn active" data-filter="all">å…¨éƒ¨</button>
    </div>

    <!-- Resources -->
    <div class="resource-grid" id="resource-list">
      <div class="empty-state">åŠ è½½ä¸­...</div>
    </div>

    <!-- Rules -->
    <div class="rules-section">
      <h2>ğŸ“‹ ä½¿ç”¨è§„åˆ™</h2>
      <div class="rules-list">
        <div class="rule-item"><span class="rule-icon">ğŸ’¬</span> å…ˆæ²Ÿé€šåä½¿ç”¨ï¼Œè”ç³»è´Ÿè´£äºº</div>
        <div class="rule-item"><span class="rule-icon">ğŸ”„</span> ä½¿ç”¨ååŠæ—¶æ›´æ–°çŠ¶æ€</div>
        <div class="rule-item"><span class="rule-icon">ğŸ¤</span> å°Šé‡ä»–äººæ—¶é—´ï¼Œç‰¹åˆ«æ˜¯äººåŠ›èµ„æº</div>
        <div class="rule-item"><span class="rule-icon">ğŸ“</span> é‡è¦ä½¿ç”¨éœ€è®°å½•åˆ°è´¡çŒ®è®°å½•</div>
      </div>
    </div>
  </main>

  <button class="back-to-top hidden" onclick="scrollToTop()" title="è¿”å›é¡¶éƒ¨">â†‘</button>

  <footer>
    <p>Â© 2026 Grassroots Project Â· ä¸ºè¢«ä½ä¼°çš„äººï¼Œæ‹¿å›ä»·å€¼</p>
  </footer>

  <script type="module">
    import { fetchResourcePool, parseResourcePool } from '../assets/js/gh-api.js';

    let resources = [];
    let currentFilter = 'all';

    async function loadAll() {
      try {
        const poolData = await fetchResourcePool();
        if (poolData) {
          resources = parseResourcePool(poolData.body);
        }
      } catch (e) {
        console.error('Load failed:', e);
      }
      renderStats();
      renderFilters();
      renderResources();
    }

    function getTypes() {
      const types = new Set();
      resources.forEach(r => {
        if (r.type) {
          r.type.split(/[/ï¼]/).map(t => t.trim()).filter(Boolean).forEach(t => types.add(t));
        }
      });
      return [...types].sort();
    }

    function getIcon(type) {
      if (type.includes('æ¯”ç‰¹å¸') || type.includes('èµ„é‡‘')) return 'ğŸ’°';
      if (type.includes('çŸ¥è¯†')) return 'ğŸ“š';
      if (type.includes('å·¥å…·')) return 'ğŸ”§';
      if (type.includes('äººåŠ›')) return 'ğŸ‘¤';
      if (type.includes('ç¤¾äº¤') || type.includes('æ²Ÿé€š')) return 'ğŸ’¬';
      return 'ğŸ“¦';
    }

    function getBadgeClass(status) {
      if (status.includes('å¯ç”¨')) return 'badge-available';
      if (status.includes('å¾…è§„åˆ’') || status.includes('æš‚åœ')) return 'badge-pending';
      if (status.includes('å ç”¨') || status.includes('ä½¿ç”¨ä¸­')) return 'badge-occupied';
      return 'badge-available';
    }

    function renderStats() {
      const total = resources.length;
      const available = resources.filter(r => r.status.includes('å¯ç”¨')).length;
      const pending = resources.filter(r => r.status.includes('å¾…è§„åˆ’') || r.status.includes('æš‚åœ')).length;

      document.getElementById('stat-total').textContent = total || '-';
      document.getElementById('stat-available').textContent = available || '-';
      document.getElementById('stat-pending').textContent = pending || '-';
    }

    function renderFilters() {
      const bar = document.getElementById('filter-bar');
      const types = getTypes();
      bar.innerHTML = '<button class="filter-btn active" data-filter="all">å…¨éƒ¨</button>'
        + types.map(t => `<button class="filter-btn" data-filter="${t}">${getIcon(t)} ${t}</button>`).join('');

      bar.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          currentFilter = btn.dataset.filter;
          bar.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          renderResources();
        });
      });
    }

    function renderResources() {
      const container = document.getElementById('resource-list');
      let filtered = resources;

      if (currentFilter !== 'all') {
        filtered = resources.filter(r => r.type && r.type.includes(currentFilter));
      }

      if (filtered.length === 0) {
        container.innerHTML = '<div class="empty-state">æš‚æ— èµ„æº</div>';
        return;
      }

      container.innerHTML = filtered.map(r => {
        const icon = getIcon(r.type);
        const badgeClass = getBadgeClass(r.status);
        const hasLink = r.link && r.link !== '-' && r.link.trim();

        return `
          <div class="resource-card">
            <div class="resource-top">
              <div class="resource-name">${icon} ${r.name}</div>
              <span class="resource-badge ${badgeClass}">${r.status}</span>
            </div>
            <div class="resource-type">${r.type || 'å…¶ä»–'}</div>
            <div class="resource-desc">${r.description || ''}</div>
            <div class="resource-meta">
              <span>ğŸ‘¤ ${r.owner || 'æœªæŒ‡å®š'}</span>
              ${r.instructions ? `<span>ğŸ“ ${r.instructions}</span>` : ''}
            </div>
            ${hasLink ? `<a class="resource-link" href="${r.link}" target="_blank">ğŸ”— è®¿é—®</a>` : ''}
          </div>
        `;
      }).join('');
    }

    window.loadAll = loadAll;
    loadAll();
  </script>

  <script>
    function toggleMenu() {
      document.getElementById('nav-menu').classList.toggle('show');
    }
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    window.addEventListener('scroll', function() {
      document.querySelector('.back-to-top').classList.toggle('hidden', window.scrollY <= 300);
    });
  </script>
</body>
</html>
